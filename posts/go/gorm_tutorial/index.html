<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>gorm을 이용하여 데이터베이스 사용하기 :: Gangjun&#39;s Blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="gorm이란 go의 ORM중 하나입니다. gorm 라이브러리를 통하여 mysql, sqlite등의 데이터베이스를 편하게 사용할 수 있습니다
 이 글은 gorm.io의 내용을 이해하기쉽게 번역/정리하여 가져온 글입니다. 자세한 내용은 gorm.io웹사이트를 참고해주세요
 목차  목차 설치하기 데이터베이스 연결하기 struct 작성하기 오토 마이그레이션 생성 쿼리  Where 사용법 Order/Limit 사용법   수정  일괄수정 Update 사용   삭제  설치하기 go get -u gorm.io/gorm go get -u gorm.io/driver/sqlite 데이터베이스 연결하기 gorm.Open(DBType, Path)로 데이터베이스를 열 수 있습니다" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://blog.gangjun.dev/posts/go/gorm_tutorial/" />







<link rel="stylesheet" href="https://blog.gangjun.dev/css/style.min.css">


  
  
  <link rel="stylesheet" href="https://blog.gangjun.dev/css/color/green.min.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://blog.gangjun.dev/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://blog.gangjun.dev/img/favicon/green.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="Gangjun" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="gorm을 이용하여 데이터베이스 사용하기 :: Gangjun&#39;s Blog">
<meta property="og:description" content="Go언어에서 gorm라이브러리를 사용하여 mysql, sqlite 등을 사용하는 방법을 알려드립니다." />
<meta property="og:url" content="https://blog.gangjun.dev/posts/go/gorm_tutorial/" />
<meta property="og:site_name" content="gorm을 이용하여 데이터베이스 사용하기" />

  
    <meta property="og:image" content="https://blog.gangjun.dev/img/favicon/green.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2020-08-11 00:00:00 &#43;0000 UTC" />












</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Gangjun Dev
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="https://gangjun.dev">About</a></li>
        
      
        
          <li><a href="https://github.com/gangjun06">github</a></li>
        
      
        
          <li><a href="https://patreon.com/gangjun">patreon</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="https://gangjun.dev">About</a></li>
      
    
      
        <li><a href="https://github.com/gangjun06">github</a></li>
      
    
      
        <li><a href="https://patreon.com/gangjun">patreon</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://blog.gangjun.dev/posts/go/gorm_tutorial/">gorm을 이용하여 데이터베이스 사용하기</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2020-08-11 
      </span>
    
    
    <span class="post-author">:: Gangjun</span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="https://blog.gangjun.dev/tags/go/">go</a>&nbsp;
    
  </span>
  

  

  

  <div class="post-content"><div>
        <p><a href="https://gorm.io">gorm</a>이란 go의 ORM중 하나입니다. <a href="https://gorm.io">gorm</a> 라이브러리를 통하여 mysql, sqlite등의 데이터베이스를 편하게 사용할 수 있습니다</p>
<blockquote>
<p>이 글은 gorm.io의 내용을 이해하기쉽게 번역/정리하여 가져온 글입니다. 자세한 내용은 gorm.io웹사이트를 참고해주세요</p>
</blockquote>
<h1 id="목차">목차<a href="#목차" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<ul>
<li><a href="#%EB%AA%A9%EC%B0%A8">목차</a></li>
<li><a href="#%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0">설치하기</a></li>
<li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%97%B0%EA%B2%B0%ED%95%98%EA%B8%B0">데이터베이스 연결하기</a></li>
<li><a href="#struct-%EC%9E%91%EC%84%B1%ED%95%98%EA%B8%B0">struct 작성하기</a></li>
<li><a href="#%EC%98%A4%ED%86%A0-%EB%A7%88%EC%9D%B4%EA%B7%B8%EB%A0%88%EC%9D%B4%EC%85%98">오토 마이그레이션</a></li>
<li><a href="#%EC%83%9D%EC%84%B1">생성</a></li>
<li><a href="#%EC%BF%BC%EB%A6%AC">쿼리</a>
<ul>
<li><a href="#where-%EC%82%AC%EC%9A%A9%EB%B2%95">Where 사용법</a></li>
<li><a href="#orderlimit-%EC%82%AC%EC%9A%A9%EB%B2%95">Order/Limit 사용법</a></li>
</ul>
</li>
<li><a href="#%EC%88%98%EC%A0%95">수정</a>
<ul>
<li><a href="#%EC%9D%BC%EA%B4%84%EC%88%98%EC%A0%95">일괄수정</a></li>
<li><a href="#update-%EC%82%AC%EC%9A%A9">Update 사용</a></li>
</ul>
</li>
<li><a href="#%EC%82%AD%EC%A0%9C">삭제</a></li>
</ul>
<h1 id="설치하기">설치하기<a href="#설치하기" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">go get -u gorm.io/gorm
go get -u gorm.io/driver/sqlite
</code></pre></div><h1 id="데이터베이스-연결하기">데이터베이스 연결하기<a href="#데이터베이스-연결하기" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>gorm.Open(DBType, Path)로 데이터베이스를 열 수 있습니다</p>
<p><strong>open하는 코드에서 import시 gorm뿐만 아니라 드라이버도 꼭 같이 불러올것</strong></p>



  <div class="collapsable-code">
    <input id="142893756" type="checkbox" checked />
    <label for="142893756">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">Sqlite</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
package main

import (
  &#34;gorm.io/driver/sqlite&#34;
  &#34;gorm.io/gorm&#34;
)

func main() {
  db, err := gorm.Open(sqlite.New(&#34;test.db&#34;))
  defer db.Close()
}
</code></pre>
  </div>





  <div class="collapsable-code">
    <input id="698137245" type="checkbox" checked />
    <label for="698137245">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">Mysql / MariaDB</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
import (
  &#34;gorm.io/driver/mysql&#34;
  &#34;gorm.io/gorm&#34;
)

func main() {
  // 예시: admin:1234@localhost/test_table?charset=utf8&amp;parseTime=True&amp;loc=Local
  db, err := gorm.Open(mysql.Open(&#34;&lt;user&gt;:&lt;password&gt;@tcp(&lt;hostname&gt;:&lt;port&gt;)/&lt;dbname&gt;?charset=utf8&amp;parseTime=True&amp;loc=Local&#34;), &amp;gorm.Config{})
  defer db.Close()
}
</code></pre>
  </div>





  <div class="collapsable-code">
    <input id="285637941" type="checkbox" checked />
    <label for="285637941">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">PostgreSQL</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
import (
  &#34;gorm.io/driver/postgres&#34;
  &#34;gorm.io/gorm&#34;
)

func main() {
  db, err := gorm.Open(postgres.New(postgres.Config{
    DSN: &#34;host=myhost port=myport user=gorm dbname=gorm password=mypassword&#34;)
    }
  )
  defer db.Close()
}
</code></pre>
  </div>


<h1 id="struct-작성하기">struct 작성하기<a href="#struct-작성하기" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>gorm을 통하여 DB에 접근하려면 먼저 Struct을 작성해주어야 합니다.</p>
<p>다음 태그들을 사용할 수 있습니다</p>
<table>
<thead>
<tr>
<th>태그이름</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr>
<td>Column</td>
<td>열 이름을 원하는것으로 지정할 수 있습니다</td>
</tr>
<tr>
<td>Type</td>
<td>타입을 지정합니다</td>
</tr>
<tr>
<td>Size</td>
<td>열의 크기를 지정합니다. 기본값:255</td>
</tr>
<tr>
<td>PRIMARY_KEY</td>
<td>열을 primary_key로 지정합니다</td>
</tr>
<tr>
<td>UNIQUE</td>
<td>열을 unique로 지정합니다</td>
</tr>
<tr>
<td>Default</td>
<td>기본값을 지정합니다</td>
</tr>
<tr>
<td>NOT_NULL</td>
<td>NULL값이 들어오지 못하도록 합니다</td>
</tr>
<tr>
<td>AUTO_INCREMENT</td>
<td>자동증가를 시켜줍니다</td>
</tr>
<tr>
<td>INDEX</td>
<td>INDEX를 생성합니다</td>
</tr>
</tbody>
</table>



  <div class="collapsable-code">
    <input id="754382619" type="checkbox"  />
    <label for="754382619">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">예제</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
type User struct {
    ID        uint `gorm:&#34;primary_key;unique_index;not null;&#34;` 
    Name      string `gorm:&#34;type:varchar(30)&#34;`
    Email     string `gorm:&#34;type:varchar(60);unique_index&#34;`
    Job       string `gorm:&#34;type:varchar(30);default:&#39;students&#39;&#34;`
    JoinAt    *time.Time
}
</code></pre>
  </div>


<h1 id="오토-마이그레이션">오토 마이그레이션<a href="#오토-마이그레이션" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>DB에 연결한 후, 테이블이 생성되있지 않으면 struct을 바탕으로 자동으로 생성해 줍니다</p>
<p>db.AutoMigrate(&hellip;interface{})</p>



  <div class="collapsable-code">
    <input id="269378541" type="checkbox"  />
    <label for="269378541">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">AutoMigrate 예제</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
package main

import (
  &#34;log&#34;

  &#34;database/sql&#34;
  &#34;gorm.io/gorm&#34;
)

type foo struct {
  Bar   string
}
  
func main() {
  db, err := gorm.Open(sqlite.New(&#34;test.db&#34;))
  if err != nil{
    log.Fatal(&#34;Error While open&#34;)
  }
	db.AutoMigrate(&amp;foo{})
  defer db.Close()
}
</code></pre>
  </div>


<h1 id="생성">생성<a href="#생성" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p><code>db.Create(&amp;foo)</code> 형식으로 사용할 수 있습니다



  <div class="collapsable-code">
    <input id="382514967" type="checkbox"  />
    <label for="382514967">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">생성 예제</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
user := User{Name: &#34;홍길동&#34;, Age: 30, CreatedAt: time.Now()}
db.Create(&amp;user)
</code></pre>
  </div>

</p>
<h1 id="쿼리">쿼리<a href="#쿼리" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>



  <div class="collapsable-code">
    <input id="328571469" type="checkbox"  />
    <label for="328571469">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">기본 사용법</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
// Primary Key기준으로 정렬해서 하나 가져오기
db.First(&amp;user)
//// SELECT * FROM users ORDER BY id LIMIT 1;

// 정렬없이 하나 가져오기
db.Take(&amp;user)
//// SELECT * FROM users LIMIT 1;

// Primary key기준으로 역순 정렬해서 하나 가져오기
db.Last(&amp;user)
//// SELECT * FROM users ORDER BY id DESC LIMIT 1;

// 전부 가져오기
db.Find(&amp;users)
//// SELECT * FROM users;

// primary_key가 n인 값 불러오기
db.First(&amp;user, n)
//// SELECT * FROM users WHERE id = n;
</code></pre>
  </div>


<h2 id="where-사용법">Where 사용법<a href="#where-사용법" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p><code>db.Where(query interface{}, args ...interface{}).Find(interface{})</code> 형식으로 사용함



  <div class="collapsable-code">
    <input id="158294763" type="checkbox" checked />
    <label for="158294763">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">Where 예제</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
// 일치하는 첫번째 레코드 
db.Where(&#34;name = ?&#34;, &#34;gangjun&#34;).First(&amp;user)
//// SELECT * FROM users WHERE name = &#39;gangjun&#39; ORDER BY id LIMIT 1;

// 일치하는 모든 레코드
db.Where(&#34;name = ?&#34;, &#34;gangjun&#34;).Find(&amp;users)
//// SELECT * FROM users WHERE name = &#39;gangjun&#39;;

// &lt;&gt;
db.Where(&#34;name &lt;&gt; ?&#34;, &#34;gangjun&#34;).Find(&amp;users)
//// SELECT * FROM users WHERE name &lt;&gt; &#39;gangjun&#39;;

// IN
db.Where(&#34;name IN (?)&#34;, []string{&#34;gangjun&#34;, &#34;gangjun 2&#34;}).Find(&amp;users)
//// SELECT * FROM users WHERE name in (&#39;gangjun&#39;,&#39;gangjun 2&#39;);

// LIKE
db.Where(&#34;name LIKE ?&#34;, &#34;%jin%&#34;).Find(&amp;users)
//// SELECT * FROM users WHERE name LIKE &#39;%jin%&#39;;

// AND
db.Where(&#34;name = ? AND age &gt;= ?&#34;, &#34;gangjun&#34;, &#34;22&#34;).Find(&amp;users)
//// SELECT * FROM users WHERE name = &#39;gangjun&#39; AND age &gt;= 22;

// Time
db.Where(&#34;updated_at &gt; ?&#34;, lastWeek).Find(&amp;users)
//// SELECT * FROM users WHERE updated_at &gt; &#39;2000-01-01 00:00:00&#39;;

// BETWEEN
db.Where(&#34;created_at BETWEEN ? AND ?&#34;, lastWeek, today).Find(&amp;users)
//// SELECT * FROM users WHERE created_at BETWEEN &#39;2000-01-01 00:00:00&#39; AND &#39;2000-01-08 00:00:00&#39;;

</code></pre>
  </div>

</p>



  <div class="collapsable-code">
    <input id="124695378" type="checkbox" checked />
    <label for="124695378">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">Where struct/map 예제</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
// Struct
db.Where(&amp;User{Name: &#34;gangjun&#34;, Age: 20}).First(&amp;user)
//// SELECT * FROM users WHERE name = &#34;gangjun&#34; AND age = 20 ORDER BY id LIMIT 1;

// Map
db.Where(map[string]interface{}{&#34;name&#34;: &#34;gangjun&#34;, &#34;age&#34;: 20}).Find(&amp;users)
//// SELECT * FROM users WHERE name = &#34;gangjun&#34; AND age = 20;

// Slice of primary keys
db.Where([]int64{20, 21, 22}).Find(&amp;users)
//// SELECT * FROM users WHERE id IN (20, 21, 22);
</code></pre>
  </div>


<h2 id="orderlimit-사용법">Order/Limit 사용법<a href="#orderlimit-사용법" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>



  <div class="collapsable-code">
    <input id="793458612" type="checkbox"  />
    <label for="793458612">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">Order/Limit 예제</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
db.Order(&#34;age desc, name&#34;).Find(&amp;users)
//// SELECT * FROM users ORDER BY age desc, name;

db.Limit(3).Find(&amp;users)
//// SELECT * FROM users LIMIT 3;
</code></pre>
  </div>


<h1 id="수정">수정<a href="#수정" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<h2 id="일괄수정">일괄수정<a href="#일괄수정" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>



  <div class="collapsable-code">
    <input id="423815796" type="checkbox"  />
    <label for="423815796">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">일괄수정 예제</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
db.First(&amp;user)
user.Name = &#34;foo&#34;
db.Save(&amp;user)
</code></pre>
  </div>


<h2 id="update-사용">Update 사용<a href="#update-사용" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p><code>db.Model(interface{}).Where().Update(&quot;key&quot;, &quot;value&quot;)</code> 형식으로 사용함



  <div class="collapsable-code">
    <input id="589174362" type="checkbox"  />
    <label for="589174362">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">Update 예제</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
db.Model(&amp;user).Where(&#34;id = ?&#34;, 10).Update(&#34;foo&#34;, &#34;bar&#34;)

// 또는 model을 활용할 수도 있음
db.Model(&amp;user).Where(&#34;id = ?&#34;, 10).Update(user{Foo: &#34;bar&#34;})
</code></pre>
  </div>

</p>
<h1 id="삭제">삭제<a href="#삭제" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p><code>db.Delete(interface{})</code>로 사용함.
주로 Where와 같이 씀</p>



  <div class="collapsable-code">
    <input id="495386172" type="checkbox"  />
    <label for="495386172">
      <span class="collapsable-code__language">go</span>
      <span class="collapsable-code__title">삭제 예제</span>
      <span class="collapsable-code__toggle" data-label-expand="△" data-label-collapse="▽"></span>
    </label>
    <pre class="language-go" ><code>
db.Where(&#34;id =  ?&#34;, 10).Delete(Users{})
</code></pre>
  </div>



      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="https://blog.gangjun.dev/posts/linux/bspwm_keys/">
                <span class="button__icon">←</span>
                <span class="button__text">Bspwm 단축키들</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="https://blog.gangjun.dev/posts/hello/">
                <span class="button__text">Hello, World!</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "gangjun-blog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2020 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>






<script src="https://blog.gangjun.dev/js/menu.js"></script>
<script src="https://blog.gangjun.dev/js/prism.js"></script>





  
</div>

</body>
</html>
